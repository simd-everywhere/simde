#define SIMDE_TEST_ARM_NEON_INSN cmla_rot90_lane

#include "test-neon.h"
#include "../../../simde/arm/neon/cmla_rot90_lane.h"
#include "../../../simde/arm/neon/dup_n.h"

static int
test_simde_vcmla_rot90_lane_f16 (SIMDE_MUNIT_TEST_ARGS) {
#if 1
  struct {
    simde_float16_t r_[4];
    simde_float16_t a[4];
    simde_float16_t b[4];
    const int lane;
    simde_float16_t r[4];
  } test_vec[] = {
    { { SIMDE_FLOAT16_VALUE(   231.50), SIMDE_FLOAT16_VALUE(   124.88), SIMDE_FLOAT16_VALUE(  -241.62), SIMDE_FLOAT16_VALUE(  -272.75) },
      { SIMDE_FLOAT16_VALUE(    26.38), SIMDE_FLOAT16_VALUE(  -235.50), SIMDE_FLOAT16_VALUE(     6.92), SIMDE_FLOAT16_VALUE(  -107.12) },
      { SIMDE_FLOAT16_VALUE(   -39.38), SIMDE_FLOAT16_VALUE(   261.25), SIMDE_FLOAT16_VALUE(   206.88), SIMDE_FLOAT16_VALUE(  -140.25) },
       INT32_C(           0),
      { SIMDE_FLOAT16_VALUE( 61760.00), SIMDE_FLOAT16_VALUE(  9400.00), SIMDE_FLOAT16_VALUE( 27744.00), SIMDE_FLOAT16_VALUE(  3946.00) } },
    { { SIMDE_FLOAT16_VALUE(    31.55), SIMDE_FLOAT16_VALUE(   -80.94), SIMDE_FLOAT16_VALUE(    41.69), SIMDE_FLOAT16_VALUE(   254.50) },
      { SIMDE_FLOAT16_VALUE(   207.25), SIMDE_FLOAT16_VALUE(   172.62), SIMDE_FLOAT16_VALUE(  -186.25), SIMDE_FLOAT16_VALUE(   272.75) },
      { SIMDE_FLOAT16_VALUE(    13.74), SIMDE_FLOAT16_VALUE(    -7.06), SIMDE_FLOAT16_VALUE(   221.50), SIMDE_FLOAT16_VALUE(   -19.20) },
       INT32_C(           1),
      { SIMDE_FLOAT16_VALUE(  3346.00), SIMDE_FLOAT16_VALUE( 38144.00), SIMDE_FLOAT16_VALUE(  5280.00), SIMDE_FLOAT16_VALUE( 60672.00) } },
    { { SIMDE_FLOAT16_VALUE(   -21.98), SIMDE_FLOAT16_VALUE(   -51.56), SIMDE_FLOAT16_VALUE(  -293.75), SIMDE_FLOAT16_VALUE(    57.72) },
      { SIMDE_FLOAT16_VALUE(   298.50), SIMDE_FLOAT16_VALUE(   169.00), SIMDE_FLOAT16_VALUE(  -116.81), SIMDE_FLOAT16_VALUE(   258.25) },
      { SIMDE_FLOAT16_VALUE(  -143.62), SIMDE_FLOAT16_VALUE(    16.39), SIMDE_FLOAT16_VALUE(   -12.13), SIMDE_FLOAT16_VALUE(   146.62) },
       INT32_C(           0),
      { SIMDE_FLOAT16_VALUE( -2792.00), SIMDE_FLOAT16_VALUE(-24320.00), SIMDE_FLOAT16_VALUE( -4528.00), SIMDE_FLOAT16_VALUE(-37024.00) } },
    { { SIMDE_FLOAT16_VALUE(   -38.91), SIMDE_FLOAT16_VALUE(  -138.25), SIMDE_FLOAT16_VALUE(  -139.62), SIMDE_FLOAT16_VALUE(    -0.96) },
      { SIMDE_FLOAT16_VALUE(   121.12), SIMDE_FLOAT16_VALUE(   299.00), SIMDE_FLOAT16_VALUE(  -283.00), SIMDE_FLOAT16_VALUE(  -184.62) },
      { SIMDE_FLOAT16_VALUE(   276.25), SIMDE_FLOAT16_VALUE(  -153.62), SIMDE_FLOAT16_VALUE(  -144.75), SIMDE_FLOAT16_VALUE(   207.25) },
       INT32_C(           1),
      { SIMDE_FLOAT16_VALUE(-62016.00), SIMDE_FLOAT16_VALUE(-43424.00), SIMDE_FLOAT16_VALUE( 38112.00), SIMDE_FLOAT16_VALUE( 26720.00) } },
    { { SIMDE_FLOAT16_VALUE(  -176.50), SIMDE_FLOAT16_VALUE(  -274.25), SIMDE_FLOAT16_VALUE(   -11.55), SIMDE_FLOAT16_VALUE(   270.75) },
      { SIMDE_FLOAT16_VALUE(   -37.00), SIMDE_FLOAT16_VALUE(  -196.62), SIMDE_FLOAT16_VALUE(   -93.56), SIMDE_FLOAT16_VALUE(  -133.00) },
      { SIMDE_FLOAT16_VALUE(  -121.94), SIMDE_FLOAT16_VALUE(  -144.00), SIMDE_FLOAT16_VALUE(   -52.09), SIMDE_FLOAT16_VALUE(    18.34) },
       INT32_C(           0),
      { SIMDE_FLOAT16_VALUE(-28496.00), SIMDE_FLOAT16_VALUE( 23696.00), SIMDE_FLOAT16_VALUE(-19168.00), SIMDE_FLOAT16_VALUE( 16496.00) } },
    { { SIMDE_FLOAT16_VALUE(  -152.50), SIMDE_FLOAT16_VALUE(   120.38), SIMDE_FLOAT16_VALUE(   123.81), SIMDE_FLOAT16_VALUE(  -107.88) },
      { SIMDE_FLOAT16_VALUE(  -260.50), SIMDE_FLOAT16_VALUE(   204.00), SIMDE_FLOAT16_VALUE(   265.75), SIMDE_FLOAT16_VALUE(  -169.88) },
      { SIMDE_FLOAT16_VALUE(  -270.00), SIMDE_FLOAT16_VALUE(    92.44), SIMDE_FLOAT16_VALUE(  -267.50), SIMDE_FLOAT16_VALUE(     3.83) },
       INT32_C(           1),
      { SIMDE_FLOAT16_VALUE(  -934.00), SIMDE_FLOAT16_VALUE(-54464.00), SIMDE_FLOAT16_VALUE(   774.50), SIMDE_FLOAT16_VALUE( 45344.00) } },
    { { SIMDE_FLOAT16_VALUE(   163.50), SIMDE_FLOAT16_VALUE(   296.50), SIMDE_FLOAT16_VALUE(   -43.03), SIMDE_FLOAT16_VALUE(   164.38) },
      { SIMDE_FLOAT16_VALUE(    51.38), SIMDE_FLOAT16_VALUE(  -252.38), SIMDE_FLOAT16_VALUE(   149.50), SIMDE_FLOAT16_VALUE(  -287.75) },
      { SIMDE_FLOAT16_VALUE(   -11.45), SIMDE_FLOAT16_VALUE(   176.75), SIMDE_FLOAT16_VALUE(  -166.25), SIMDE_FLOAT16_VALUE(   277.50) },
       INT32_C(           0),
      { SIMDE_FLOAT16_VALUE( 44768.00), SIMDE_FLOAT16_VALUE(  3186.00), SIMDE_FLOAT16_VALUE( 50816.00), SIMDE_FLOAT16_VALUE(  3460.00) } },
    { { SIMDE_FLOAT16_VALUE(   208.00), SIMDE_FLOAT16_VALUE(   236.88), SIMDE_FLOAT16_VALUE(   -88.75), SIMDE_FLOAT16_VALUE(    20.41) },
      { SIMDE_FLOAT16_VALUE(  -282.00), SIMDE_FLOAT16_VALUE(   282.25), SIMDE_FLOAT16_VALUE(    67.06), SIMDE_FLOAT16_VALUE(    40.97) },
      { SIMDE_FLOAT16_VALUE(  -151.75), SIMDE_FLOAT16_VALUE(   149.50), SIMDE_FLOAT16_VALUE(   -88.25), SIMDE_FLOAT16_VALUE(  -134.50) },
       INT32_C(           1),
      { SIMDE_FLOAT16_VALUE( 38176.00), SIMDE_FLOAT16_VALUE(-24672.00), SIMDE_FLOAT16_VALUE(  5420.00), SIMDE_FLOAT16_VALUE( -3596.00) } }
  };

  for (size_t i = 0 ; i < (sizeof(test_vec) / sizeof(test_vec[0])) ; i++) {
    simde_float16x4_t r_ = simde_vld1_f16(test_vec[i].r_);
    simde_float16x4_t a = simde_vld1_f16(test_vec[i].a);
    simde_float16x4_t b = simde_vld1_f16(test_vec[i].b);
    simde_float16x4_t r;
    SIMDE_CONSTIFY_2_(simde_vcmla_rot90_lane_f16, r, (HEDLEY_UNREACHABLE(), simde_vdup_n_f16(SIMDE_FLOAT16_VALUE(0.0))), test_vec[i].lane, r_, a, b);
    simde_test_arm_neon_assert_equal_f16x4(r, simde_vld1_f16(test_vec[i].r), 1);
  }

  return 0;
#else
  fputc('\n', stdout);
  const int lanes[] = { 0, 1, 0, 1, 0, 1, 0, 1 };
  for (int i = 0 ; i < 8 ; i++) {
    simde_float16x4_t r_ = simde_test_arm_neon_random_f16x4(-300.0f, 300.0f);
    simde_float16x4_t a = simde_test_arm_neon_random_f16x4(-300.0f, 300.0f);
    simde_float16x4_t b = simde_test_arm_neon_random_f16x4(-300.0f, 300.0f);
    simde_float16x4_t r;
    if(i % 2)
      r = simde_vcmla_rot90_lane_f16(r_, a, b, 1);
    else
      r = simde_vcmla_rot90_lane_f16(r_, a, b, 0);


    simde_test_arm_neon_write_f16x4(2, r_, SIMDE_TEST_VEC_POS_FIRST);
    simde_test_arm_neon_write_f16x4(2, a, SIMDE_TEST_VEC_POS_MIDDLE);
    simde_test_arm_neon_write_f16x4(2, b, SIMDE_TEST_VEC_POS_MIDDLE);
    simde_test_codegen_write_i32(2, lanes[i], SIMDE_TEST_VEC_POS_MIDDLE);
    simde_test_arm_neon_write_f16x4(2, r, SIMDE_TEST_VEC_POS_LAST);
  }
  return 1;
#endif
}

static int
test_simde_vcmla_rot90_lane_f32 (SIMDE_MUNIT_TEST_ARGS) {
#if 1
  static const struct {
    simde_float32_t r_[2];
    simde_float32_t a[2];
    simde_float32_t b[2];
    const int lane;
    simde_float32_t r[2];
  } test_vec[] = {
    { { SIMDE_FLOAT32_C(   948.37), SIMDE_FLOAT32_C(  -663.54) },
      { SIMDE_FLOAT32_C(  -129.24), SIMDE_FLOAT32_C(  -112.47) },
      { SIMDE_FLOAT32_C(  -263.58), SIMDE_FLOAT32_C(    59.47) },
       INT32_C(           0),
      { SIMDE_FLOAT32_C(  7636.96), SIMDE_FLOAT32_C( 28981.30) } },
    { { SIMDE_FLOAT32_C(  -508.18), SIMDE_FLOAT32_C(  -977.36) },
      { SIMDE_FLOAT32_C(  -434.66), SIMDE_FLOAT32_C(   747.76) },
      { SIMDE_FLOAT32_C(  -378.73), SIMDE_FLOAT32_C(   660.91) },
       INT32_C(           0),
      { SIMDE_FLOAT32_C(-494710.22), SIMDE_FLOAT32_C(-284176.53) } },
    { { SIMDE_FLOAT32_C(    -2.91), SIMDE_FLOAT32_C(  -847.24) },
      { SIMDE_FLOAT32_C(   389.83), SIMDE_FLOAT32_C(  -122.97) },
      { SIMDE_FLOAT32_C(  -797.93), SIMDE_FLOAT32_C(  -854.27) },
       INT32_C(           0),
      { SIMDE_FLOAT32_C(-105052.49), SIMDE_FLOAT32_C( 97274.21) } },
    { { SIMDE_FLOAT32_C(   360.11), SIMDE_FLOAT32_C(   284.83) },
      { SIMDE_FLOAT32_C(  -841.33), SIMDE_FLOAT32_C(  -170.61) },
      { SIMDE_FLOAT32_C(   604.14), SIMDE_FLOAT32_C(  -210.88) },
       INT32_C(           0),
      { SIMDE_FLOAT32_C(-35618.13), SIMDE_FLOAT32_C(-102787.50) } },
    { { SIMDE_FLOAT32_C(  -203.88), SIMDE_FLOAT32_C(  -689.37) },
      { SIMDE_FLOAT32_C(  -229.77), SIMDE_FLOAT32_C(   315.27) },
      { SIMDE_FLOAT32_C(   693.42), SIMDE_FLOAT32_C(   382.15) },
       INT32_C(           0),
      { SIMDE_FLOAT32_C(-120684.30), SIMDE_FLOAT32_C(217925.14) } },
    { { SIMDE_FLOAT32_C(   794.62), SIMDE_FLOAT32_C(  -789.91) },
      { SIMDE_FLOAT32_C(    64.55), SIMDE_FLOAT32_C(   816.06) },
      { SIMDE_FLOAT32_C(  -543.43), SIMDE_FLOAT32_C(   617.50) },
       INT32_C(           0),
      { SIMDE_FLOAT32_C(-503122.44), SIMDE_FLOAT32_C(-444261.38) } },
    { { SIMDE_FLOAT32_C(   366.21), SIMDE_FLOAT32_C(   893.09) },
      { SIMDE_FLOAT32_C(   116.22), SIMDE_FLOAT32_C(  -634.33) },
      { SIMDE_FLOAT32_C(   768.03), SIMDE_FLOAT32_C(   342.13) },
       INT32_C(           0),
      { SIMDE_FLOAT32_C(217389.55), SIMDE_FLOAT32_C(-486291.41) } },
    { { SIMDE_FLOAT32_C(   163.12), SIMDE_FLOAT32_C(  -390.83) },
      { SIMDE_FLOAT32_C(  -692.36), SIMDE_FLOAT32_C(  -453.71) },
      { SIMDE_FLOAT32_C(   550.47), SIMDE_FLOAT32_C(  -183.75) },
       INT32_C(           0),
      { SIMDE_FLOAT32_C(-83206.09), SIMDE_FLOAT32_C(-250144.56) } }
  };

  for (size_t i = 0 ; i < (sizeof(test_vec) / sizeof(test_vec[0])) ; i++) {
    simde_float32x2_t r_ = simde_vld1_f32(test_vec[i].r_);
    simde_float32x2_t a = simde_vld1_f32(test_vec[i].a);
    simde_float32x2_t b = simde_vld1_f32(test_vec[i].b);
    simde_float32x2_t r = simde_vcmla_rot90_lane_f32(r_, a, b, 0);
    simde_test_arm_neon_assert_equal_f32x2(r, simde_vld1_f32(test_vec[i].r), 1);
  }
  
  return 0;
#else
  fputc('\n', stdout);
  const int lanes[] = { 0, 0, 0, 0, 0, 0, 0, 0 };
  for (int i = 0 ; i < 8 ; i++) {
    simde_float32x2_t r_ = simde_test_arm_neon_random_f32x2(-1000.0f, 1000.0f);
    simde_float32x2_t a = simde_test_arm_neon_random_f32x2(-1000.0f, 1000.0f);
    simde_float32x2_t b = simde_test_arm_neon_random_f32x2(-1000.0f, 1000.0f);
    simde_float32x2_t r = simde_vcmla_rot90_lane_f32(r_, a, b, 0);


    simde_test_arm_neon_write_f32x2(2, r_, SIMDE_TEST_VEC_POS_FIRST);
    simde_test_arm_neon_write_f32x2(2, a, SIMDE_TEST_VEC_POS_MIDDLE);
    simde_test_arm_neon_write_f32x2(2, b, SIMDE_TEST_VEC_POS_MIDDLE);
    simde_test_codegen_write_i32(2, 0, SIMDE_TEST_VEC_POS_MIDDLE);
    simde_test_arm_neon_write_f32x2(2, r, SIMDE_TEST_VEC_POS_LAST);
  }
  return 1;
#endif
}


static int
test_simde_vcmla_rot90_laneq_f16 (SIMDE_MUNIT_TEST_ARGS) {
#if 1
  struct {
    simde_float16_t r_[4];
    simde_float16_t a[4];
    simde_float16_t b[8];
    const int lane;
    simde_float16_t r[4];
  } test_vec[] = {
    { { SIMDE_FLOAT16_VALUE(  -145.25), SIMDE_FLOAT16_VALUE(    39.50), SIMDE_FLOAT16_VALUE(    55.31), SIMDE_FLOAT16_VALUE(  -221.88) },
      { SIMDE_FLOAT16_VALUE(   105.50), SIMDE_FLOAT16_VALUE(  -208.75), SIMDE_FLOAT16_VALUE(    29.83), SIMDE_FLOAT16_VALUE(  -208.25) },
      { SIMDE_FLOAT16_VALUE(  -228.50), SIMDE_FLOAT16_VALUE(   -49.47), SIMDE_FLOAT16_VALUE(  -271.75), SIMDE_FLOAT16_VALUE(   -22.83),
        SIMDE_FLOAT16_VALUE(   221.12), SIMDE_FLOAT16_VALUE(   217.88), SIMDE_FLOAT16_VALUE(   224.75), SIMDE_FLOAT16_VALUE(    25.00) },
       INT32_C(           0),
      { SIMDE_FLOAT16_VALUE(-10472.00), SIMDE_FLOAT16_VALUE( 47744.00), SIMDE_FLOAT16_VALUE(-10248.00), SIMDE_FLOAT16_VALUE( 47360.00) } },
    { { SIMDE_FLOAT16_VALUE(   220.25), SIMDE_FLOAT16_VALUE(  -259.75), SIMDE_FLOAT16_VALUE(   -72.81), SIMDE_FLOAT16_VALUE(   138.88) },
      { SIMDE_FLOAT16_VALUE(  -136.38), SIMDE_FLOAT16_VALUE(  -138.25), SIMDE_FLOAT16_VALUE(  -101.00), SIMDE_FLOAT16_VALUE(  -140.88) },
      { SIMDE_FLOAT16_VALUE(   180.00), SIMDE_FLOAT16_VALUE(   262.25), SIMDE_FLOAT16_VALUE(     3.55), SIMDE_FLOAT16_VALUE(   247.62),
        SIMDE_FLOAT16_VALUE(   213.12), SIMDE_FLOAT16_VALUE(  -163.50), SIMDE_FLOAT16_VALUE(   175.50), SIMDE_FLOAT16_VALUE(   155.88) },
       INT32_C(           1),
      { SIMDE_FLOAT16_VALUE( 34464.00), SIMDE_FLOAT16_VALUE(  -750.50), SIMDE_FLOAT16_VALUE( 34816.00), SIMDE_FLOAT16_VALUE(  -361.25) } },
    { { SIMDE_FLOAT16_VALUE(  -223.88), SIMDE_FLOAT16_VALUE(   133.75), SIMDE_FLOAT16_VALUE(   -96.12), SIMDE_FLOAT16_VALUE(  -136.50) },
      { SIMDE_FLOAT16_VALUE(  -235.88), SIMDE_FLOAT16_VALUE(   -44.03), SIMDE_FLOAT16_VALUE(   226.00), SIMDE_FLOAT16_VALUE(    52.94) },
      { SIMDE_FLOAT16_VALUE(     4.27), SIMDE_FLOAT16_VALUE(   282.25), SIMDE_FLOAT16_VALUE(   190.75), SIMDE_FLOAT16_VALUE(    29.61),
        SIMDE_FLOAT16_VALUE(   294.00), SIMDE_FLOAT16_VALUE(    66.19), SIMDE_FLOAT16_VALUE(    49.69), SIMDE_FLOAT16_VALUE(   169.50) },
       INT32_C(           0),
      { SIMDE_FLOAT16_VALUE( 12200.00), SIMDE_FLOAT16_VALUE(   -54.25), SIMDE_FLOAT16_VALUE(-15040.00), SIMDE_FLOAT16_VALUE(    89.50) } },
    { { SIMDE_FLOAT16_VALUE(   -69.00), SIMDE_FLOAT16_VALUE(   101.75), SIMDE_FLOAT16_VALUE(  -227.00), SIMDE_FLOAT16_VALUE(   185.00) },
      { SIMDE_FLOAT16_VALUE(    17.22), SIMDE_FLOAT16_VALUE(   282.50), SIMDE_FLOAT16_VALUE(   -19.38), SIMDE_FLOAT16_VALUE(   212.75) },
      { SIMDE_FLOAT16_VALUE(  -114.12), SIMDE_FLOAT16_VALUE(   -64.44), SIMDE_FLOAT16_VALUE(  -151.25), SIMDE_FLOAT16_VALUE(    -3.73),
        SIMDE_FLOAT16_VALUE(   226.25), SIMDE_FLOAT16_VALUE(    74.81), SIMDE_FLOAT16_VALUE(   -61.75), SIMDE_FLOAT16_VALUE(     8.32) },
       INT32_C(           1),
      { SIMDE_FLOAT16_VALUE(   985.00), SIMDE_FLOAT16_VALUE(-42624.00), SIMDE_FLOAT16_VALUE(   566.50), SIMDE_FLOAT16_VALUE(-32000.00) } },
    { { SIMDE_FLOAT16_VALUE(    84.00), SIMDE_FLOAT16_VALUE(   -64.25), SIMDE_FLOAT16_VALUE(  -113.00), SIMDE_FLOAT16_VALUE(   138.75) },
      { SIMDE_FLOAT16_VALUE(   -53.62), SIMDE_FLOAT16_VALUE(   135.75), SIMDE_FLOAT16_VALUE(  -228.75), SIMDE_FLOAT16_VALUE(    48.84) },
      { SIMDE_FLOAT16_VALUE(   109.75), SIMDE_FLOAT16_VALUE(   201.75), SIMDE_FLOAT16_VALUE(  -258.75), SIMDE_FLOAT16_VALUE(   -58.72),
        SIMDE_FLOAT16_VALUE(   205.38), SIMDE_FLOAT16_VALUE(  -237.38), SIMDE_FLOAT16_VALUE(   -16.84), SIMDE_FLOAT16_VALUE(    60.72) },
       INT32_C(           0),
      { SIMDE_FLOAT16_VALUE(-27296.00), SIMDE_FLOAT16_VALUE( 14832.00), SIMDE_FLOAT16_VALUE( -9968.00), SIMDE_FLOAT16_VALUE(  5500.00) } },
    { { SIMDE_FLOAT16_VALUE(   118.38), SIMDE_FLOAT16_VALUE(  -237.62), SIMDE_FLOAT16_VALUE(    -0.65), SIMDE_FLOAT16_VALUE(  -107.38) },
      { SIMDE_FLOAT16_VALUE(   -87.75), SIMDE_FLOAT16_VALUE(   121.88), SIMDE_FLOAT16_VALUE(   -99.25), SIMDE_FLOAT16_VALUE(   129.25) },
      { SIMDE_FLOAT16_VALUE(  -114.25), SIMDE_FLOAT16_VALUE(   166.12), SIMDE_FLOAT16_VALUE(    78.75), SIMDE_FLOAT16_VALUE(   -51.97),
        SIMDE_FLOAT16_VALUE(   262.25), SIMDE_FLOAT16_VALUE(    71.81), SIMDE_FLOAT16_VALUE(  -108.94), SIMDE_FLOAT16_VALUE(    35.88) },
       INT32_C(           1),
      { SIMDE_FLOAT16_VALUE(  6452.00), SIMDE_FLOAT16_VALUE(  9360.00), SIMDE_FLOAT16_VALUE(  6716.00), SIMDE_FLOAT16_VALUE( 10072.00) } },
    { { SIMDE_FLOAT16_VALUE(    87.00), SIMDE_FLOAT16_VALUE(   278.25), SIMDE_FLOAT16_VALUE(  -132.25), SIMDE_FLOAT16_VALUE(  -215.75) },
      { SIMDE_FLOAT16_VALUE(  -108.88), SIMDE_FLOAT16_VALUE(   -78.06), SIMDE_FLOAT16_VALUE(  -127.31), SIMDE_FLOAT16_VALUE(  -267.25) },
      { SIMDE_FLOAT16_VALUE(    65.62), SIMDE_FLOAT16_VALUE(  -169.88), SIMDE_FLOAT16_VALUE(    68.69), SIMDE_FLOAT16_VALUE(   143.62),
        SIMDE_FLOAT16_VALUE(    98.62), SIMDE_FLOAT16_VALUE(   -42.59), SIMDE_FLOAT16_VALUE(  -243.88), SIMDE_FLOAT16_VALUE(    82.75) },
       INT32_C(           0),
      { SIMDE_FLOAT16_VALUE(-13176.00), SIMDE_FLOAT16_VALUE( -4844.00), SIMDE_FLOAT16_VALUE(-45536.00), SIMDE_FLOAT16_VALUE(-17760.00) } },
    { { SIMDE_FLOAT16_VALUE(  -262.25), SIMDE_FLOAT16_VALUE(   208.12), SIMDE_FLOAT16_VALUE(   168.38), SIMDE_FLOAT16_VALUE(   197.38) },
      { SIMDE_FLOAT16_VALUE(   268.75), SIMDE_FLOAT16_VALUE(   194.50), SIMDE_FLOAT16_VALUE(  -242.00), SIMDE_FLOAT16_VALUE(  -158.25) },
      { SIMDE_FLOAT16_VALUE(    -8.37), SIMDE_FLOAT16_VALUE(  -199.12), SIMDE_FLOAT16_VALUE(   114.25), SIMDE_FLOAT16_VALUE(   232.75),
        SIMDE_FLOAT16_VALUE(  -108.00), SIMDE_FLOAT16_VALUE(   -25.03), SIMDE_FLOAT16_VALUE(  -141.75), SIMDE_FLOAT16_VALUE(  -202.62) },
       INT32_C(           1),
      { SIMDE_FLOAT16_VALUE(-45536.00), SIMDE_FLOAT16_VALUE( 22432.00), SIMDE_FLOAT16_VALUE( 36992.00), SIMDE_FLOAT16_VALUE(-17888.00) } }
  };

  for (size_t i = 0 ; i < (sizeof(test_vec) / sizeof(test_vec[0])) ; i++) {
    simde_float16x4_t r_ = simde_vld1_f16(test_vec[i].r_);
    simde_float16x4_t a = simde_vld1_f16(test_vec[i].a);
    simde_float16x8_t b = simde_vld1q_f16(test_vec[i].b);
    simde_float16x4_t r;
    SIMDE_CONSTIFY_2_(simde_vcmla_rot90_laneq_f16, r, (HEDLEY_UNREACHABLE(), simde_vdup_n_f16(SIMDE_FLOAT16_VALUE(0.0))), test_vec[i].lane, r_, a, b);

    simde_test_arm_neon_assert_equal_f16x4(r, simde_vld1_f16(test_vec[i].r), 1);
  }
  return 0;
#else
  fputc('\n', stdout);
  const int lanes[] = { 0, 1, 0, 1, 0, 1, 0, 1 };
  for (int i = 0 ; i < 8 ; i++) {
    simde_float16x4_t r_ = simde_test_arm_neon_random_f16x4(-300.0f, 300.0f);
    simde_float16x4_t a = simde_test_arm_neon_random_f16x4(-300.0f, 300.0f);
    simde_float16x8_t b = simde_test_arm_neon_random_f16x8(-300.0f, 300.0f);
    simde_float16x4_t r;
    if(i % 2)
      r = simde_vcmla_rot90_laneq_f16(r_, a, b, 1);
    else
      r = simde_vcmla_rot90_laneq_f16(r_, a, b, 0);


    simde_test_arm_neon_write_f16x4(2, r_, SIMDE_TEST_VEC_POS_FIRST);
    simde_test_arm_neon_write_f16x4(2, a, SIMDE_TEST_VEC_POS_MIDDLE);
    simde_test_arm_neon_write_f16x8(2, b, SIMDE_TEST_VEC_POS_MIDDLE);
    simde_test_codegen_write_i32(2, lanes[i], SIMDE_TEST_VEC_POS_MIDDLE);
    simde_test_arm_neon_write_f16x4(2, r, SIMDE_TEST_VEC_POS_LAST);
  }
  return 1;
#endif
}

static int
test_simde_vcmla_rot90_laneq_f32 (SIMDE_MUNIT_TEST_ARGS) {
#if 1
  static const struct {
    simde_float32_t r_[2];
    simde_float32_t a[2];
    simde_float32_t b[4];
    const int lane;
    simde_float32_t r[2];
  } test_vec[] = {
    { { SIMDE_FLOAT32_C(  -931.69), SIMDE_FLOAT32_C(  -920.70) },
      { SIMDE_FLOAT32_C(  -221.33), SIMDE_FLOAT32_C(   120.64) },
      { SIMDE_FLOAT32_C(  -383.16), SIMDE_FLOAT32_C(   277.79), SIMDE_FLOAT32_C(   760.23), SIMDE_FLOAT32_C(  -771.08) },
       INT32_C(           0),
      { SIMDE_FLOAT32_C(-34444.28), SIMDE_FLOAT32_C(-47145.12) } },
    { { SIMDE_FLOAT32_C(   482.81), SIMDE_FLOAT32_C(   547.77) },
      { SIMDE_FLOAT32_C(   310.06), SIMDE_FLOAT32_C(  -790.26) },
      { SIMDE_FLOAT32_C(    41.72), SIMDE_FLOAT32_C(  -878.04), SIMDE_FLOAT32_C(   847.25), SIMDE_FLOAT32_C(  -343.42) },
       INT32_C(           1),
      { SIMDE_FLOAT32_C(-270908.28), SIMDE_FLOAT32_C(-669000.00) } },
    { { SIMDE_FLOAT32_C(   142.06), SIMDE_FLOAT32_C(  -462.51) },
      { SIMDE_FLOAT32_C(   649.55), SIMDE_FLOAT32_C(   949.61) },
      { SIMDE_FLOAT32_C(   143.14), SIMDE_FLOAT32_C(  -184.10), SIMDE_FLOAT32_C(  -161.62), SIMDE_FLOAT32_C(  -376.45) },
       INT32_C(           0),
      { SIMDE_FLOAT32_C(174965.27), SIMDE_FLOAT32_C(135464.66) } },
    { { SIMDE_FLOAT32_C(   939.75), SIMDE_FLOAT32_C(   371.20) },
      { SIMDE_FLOAT32_C(   828.46), SIMDE_FLOAT32_C(  -145.73) },
      { SIMDE_FLOAT32_C(   697.35), SIMDE_FLOAT32_C(   334.07), SIMDE_FLOAT32_C(   740.00), SIMDE_FLOAT32_C(  -878.77) },
       INT32_C(           1),
      { SIMDE_FLOAT32_C(-127123.40), SIMDE_FLOAT32_C(-107469.00) } },
    { { SIMDE_FLOAT32_C(   440.15), SIMDE_FLOAT32_C(  -409.74) },
      { SIMDE_FLOAT32_C(  -441.59), SIMDE_FLOAT32_C(   235.26) },
      { SIMDE_FLOAT32_C(   -55.32), SIMDE_FLOAT32_C(   265.28), SIMDE_FLOAT32_C(   595.33), SIMDE_FLOAT32_C(  -346.56) },
       INT32_C(           0),
      { SIMDE_FLOAT32_C(-61969.62), SIMDE_FLOAT32_C(-13424.32) } },
    { { SIMDE_FLOAT32_C(  -678.02), SIMDE_FLOAT32_C(   583.77) },
      { SIMDE_FLOAT32_C(  -602.68), SIMDE_FLOAT32_C(   713.06) },
      { SIMDE_FLOAT32_C(   451.06), SIMDE_FLOAT32_C(   894.88), SIMDE_FLOAT32_C(   288.08), SIMDE_FLOAT32_C(  -204.22) },
       INT32_C(           1),
      { SIMDE_FLOAT32_C(144943.09), SIMDE_FLOAT32_C(206002.08) } },
    { { SIMDE_FLOAT32_C(  -351.68), SIMDE_FLOAT32_C(  -767.19) },
      { SIMDE_FLOAT32_C(   -90.50), SIMDE_FLOAT32_C(   992.18) },
      { SIMDE_FLOAT32_C(  -451.98), SIMDE_FLOAT32_C(  -425.01), SIMDE_FLOAT32_C(   806.62), SIMDE_FLOAT32_C(   872.81) },
       INT32_C(           0),
      { SIMDE_FLOAT32_C(421334.75), SIMDE_FLOAT32_C(-449212.72) } },
    { { SIMDE_FLOAT32_C(  -699.20), SIMDE_FLOAT32_C(   623.90) },
      { SIMDE_FLOAT32_C(   -67.54), SIMDE_FLOAT32_C(   776.35) },
      { SIMDE_FLOAT32_C(   112.90), SIMDE_FLOAT32_C(  -529.17), SIMDE_FLOAT32_C(   300.41), SIMDE_FLOAT32_C(   915.76) },
       INT32_C(           1),
      { SIMDE_FLOAT32_C(-711649.44), SIMDE_FLOAT32_C(233847.20) } }
  };

  for (size_t i = 0 ; i < (sizeof(test_vec) / sizeof(test_vec[0])) ; i++) {
    simde_float32x2_t r_ = simde_vld1_f32(test_vec[i].r_);
    simde_float32x2_t a = simde_vld1_f32(test_vec[i].a);
    simde_float32x4_t b = simde_vld1q_f32(test_vec[i].b);
    simde_float32x2_t r;
    SIMDE_CONSTIFY_2_(simde_vcmla_rot90_laneq_f32, r, (HEDLEY_UNREACHABLE(), simde_vdup_n_f32(SIMDE_FLOAT32_C(0.0))), test_vec[i].lane, r_, a, b);

    simde_test_arm_neon_assert_equal_f32x2(r, simde_vld1_f32(test_vec[i].r), 1);
  }
  return 0;
#else
  fputc('\n', stdout);
  const int lanes[] = { 0, 1, 0, 1, 0, 1, 0, 1 };
  for (int i = 0 ; i < 8 ; i++) {
    simde_float32x2_t r_ = simde_test_arm_neon_random_f32x2(-1000.0f, 1000.0f);
    simde_float32x2_t a = simde_test_arm_neon_random_f32x2(-1000.0f, 1000.0f);
    simde_float32x4_t b = simde_test_arm_neon_random_f32x4(-1000.0f, 1000.0f);
    simde_float32x2_t r;
    if(i % 2)
      r = simde_vcmla_rot90_laneq_f32(r_, a, b, 1);
    else
      r = simde_vcmla_rot90_laneq_f32(r_, a, b, 0);


    simde_test_arm_neon_write_f32x2(2, r_, SIMDE_TEST_VEC_POS_FIRST);
    simde_test_arm_neon_write_f32x2(2, a, SIMDE_TEST_VEC_POS_MIDDLE);
    simde_test_arm_neon_write_f32x4(2, b, SIMDE_TEST_VEC_POS_MIDDLE);
    simde_test_codegen_write_i32(2, lanes[i], SIMDE_TEST_VEC_POS_MIDDLE);
    simde_test_arm_neon_write_f32x2(2, r, SIMDE_TEST_VEC_POS_LAST);
  }
  return 1;
#endif
}

static int
test_simde_vcmlaq_rot90_lane_f16 (SIMDE_MUNIT_TEST_ARGS) {
#if 1
  struct {
    simde_float16_t r_[8];
    simde_float16_t a[8];
    simde_float16_t b[4];
    const int lane;
    simde_float16_t r[8];
  } test_vec[] = {
    { { SIMDE_FLOAT16_VALUE(    29.27), SIMDE_FLOAT16_VALUE(   -45.75), SIMDE_FLOAT16_VALUE(   109.12), SIMDE_FLOAT16_VALUE(  -287.75),
        SIMDE_FLOAT16_VALUE(   113.19), SIMDE_FLOAT16_VALUE(   250.00), SIMDE_FLOAT16_VALUE(   121.56), SIMDE_FLOAT16_VALUE(  -240.62) },
      { SIMDE_FLOAT16_VALUE(  -125.88), SIMDE_FLOAT16_VALUE(   -82.38), SIMDE_FLOAT16_VALUE(   297.00), SIMDE_FLOAT16_VALUE(   218.38),
        SIMDE_FLOAT16_VALUE(   285.25), SIMDE_FLOAT16_VALUE(  -198.12), SIMDE_FLOAT16_VALUE(   -89.19), SIMDE_FLOAT16_VALUE(   171.75) },
      { SIMDE_FLOAT16_VALUE(   200.12), SIMDE_FLOAT16_VALUE(   125.88), SIMDE_FLOAT16_VALUE(  -161.00), SIMDE_FLOAT16_VALUE(   -41.06) },
       INT32_C(           0),
      { SIMDE_FLOAT16_VALUE( 10400.00), SIMDE_FLOAT16_VALUE(-16528.00), SIMDE_FLOAT16_VALUE(-27376.00), SIMDE_FLOAT16_VALUE( 43424.00),
        SIMDE_FLOAT16_VALUE( 25056.00), SIMDE_FLOAT16_VALUE(-39392.00), SIMDE_FLOAT16_VALUE(-21504.00), SIMDE_FLOAT16_VALUE( 34144.00) } },
    { { SIMDE_FLOAT16_VALUE(  -230.50), SIMDE_FLOAT16_VALUE(   276.50), SIMDE_FLOAT16_VALUE(  -279.25), SIMDE_FLOAT16_VALUE(   190.75),
        SIMDE_FLOAT16_VALUE(  -120.44), SIMDE_FLOAT16_VALUE(    72.31), SIMDE_FLOAT16_VALUE(    18.89), SIMDE_FLOAT16_VALUE(    77.06) },
      { SIMDE_FLOAT16_VALUE(   260.75), SIMDE_FLOAT16_VALUE(  -253.88), SIMDE_FLOAT16_VALUE(   112.94), SIMDE_FLOAT16_VALUE(   151.00),
        SIMDE_FLOAT16_VALUE(    88.06), SIMDE_FLOAT16_VALUE(   276.00), SIMDE_FLOAT16_VALUE(   207.75), SIMDE_FLOAT16_VALUE(  -207.88) },
      { SIMDE_FLOAT16_VALUE(  -195.75), SIMDE_FLOAT16_VALUE(   180.00), SIMDE_FLOAT16_VALUE(   -59.84), SIMDE_FLOAT16_VALUE(   -68.38) },
       INT32_C(           1),
      { SIMDE_FLOAT16_VALUE(-17584.00), SIMDE_FLOAT16_VALUE( 15472.00), SIMDE_FLOAT16_VALUE( 10048.00), SIMDE_FLOAT16_VALUE( -8848.00),
        SIMDE_FLOAT16_VALUE( 18752.00), SIMDE_FLOAT16_VALUE(-16448.00), SIMDE_FLOAT16_VALUE(-14192.00), SIMDE_FLOAT16_VALUE( 12520.00) } },
    { { SIMDE_FLOAT16_VALUE(    67.94), SIMDE_FLOAT16_VALUE(   261.25), SIMDE_FLOAT16_VALUE(  -143.12), SIMDE_FLOAT16_VALUE(   252.75),
        SIMDE_FLOAT16_VALUE(   103.19), SIMDE_FLOAT16_VALUE(    75.25), SIMDE_FLOAT16_VALUE(   160.25), SIMDE_FLOAT16_VALUE(   136.00) },
      { SIMDE_FLOAT16_VALUE(   -65.19), SIMDE_FLOAT16_VALUE(  -246.00), SIMDE_FLOAT16_VALUE(    79.12), SIMDE_FLOAT16_VALUE(   129.50),
        SIMDE_FLOAT16_VALUE(  -159.62), SIMDE_FLOAT16_VALUE(  -272.50), SIMDE_FLOAT16_VALUE(   243.88), SIMDE_FLOAT16_VALUE(   -80.56) },
      { SIMDE_FLOAT16_VALUE(    32.34), SIMDE_FLOAT16_VALUE(   -32.38), SIMDE_FLOAT16_VALUE(   156.25), SIMDE_FLOAT16_VALUE(  -273.00) },
       INT32_C(           0),
      { SIMDE_FLOAT16_VALUE( -7896.00), SIMDE_FLOAT16_VALUE( -7696.00), SIMDE_FLOAT16_VALUE(  4050.00), SIMDE_FLOAT16_VALUE(  4440.00),
        SIMDE_FLOAT16_VALUE( -8720.00), SIMDE_FLOAT16_VALUE( -8736.00), SIMDE_FLOAT16_VALUE( -2448.00), SIMDE_FLOAT16_VALUE( -2470.00) } },
    { { SIMDE_FLOAT16_VALUE(  -261.50), SIMDE_FLOAT16_VALUE(   237.00), SIMDE_FLOAT16_VALUE(   -35.09), SIMDE_FLOAT16_VALUE(    95.44),
        SIMDE_FLOAT16_VALUE(   253.62), SIMDE_FLOAT16_VALUE(   202.38), SIMDE_FLOAT16_VALUE(  -210.88), SIMDE_FLOAT16_VALUE(  -226.62) },
      { SIMDE_FLOAT16_VALUE(  -300.00), SIMDE_FLOAT16_VALUE(  -215.38), SIMDE_FLOAT16_VALUE(  -113.44), SIMDE_FLOAT16_VALUE(  -295.25),
        SIMDE_FLOAT16_VALUE(   225.25), SIMDE_FLOAT16_VALUE(   -20.62), SIMDE_FLOAT16_VALUE(    86.75), SIMDE_FLOAT16_VALUE(   146.38) },
      { SIMDE_FLOAT16_VALUE(  -214.62), SIMDE_FLOAT16_VALUE(   252.75), SIMDE_FLOAT16_VALUE(  -200.38), SIMDE_FLOAT16_VALUE(   124.44) },
       INT32_C(           1),
      { SIMDE_FLOAT16_VALUE( 26544.00), SIMDE_FLOAT16_VALUE( 43392.00), SIMDE_FLOAT16_VALUE( 36704.00), SIMDE_FLOAT16_VALUE( 59264.00),
        SIMDE_FLOAT16_VALUE(  2820.00), SIMDE_FLOAT16_VALUE(  4336.00), SIMDE_FLOAT16_VALUE(-18432.00), SIMDE_FLOAT16_VALUE(-29552.00) } },
    { { SIMDE_FLOAT16_VALUE(   229.75), SIMDE_FLOAT16_VALUE(   297.25), SIMDE_FLOAT16_VALUE(   293.75), SIMDE_FLOAT16_VALUE(   -72.81),
        SIMDE_FLOAT16_VALUE(  -181.50), SIMDE_FLOAT16_VALUE(  -232.88), SIMDE_FLOAT16_VALUE(   132.75), SIMDE_FLOAT16_VALUE(  -210.00) },
      { SIMDE_FLOAT16_VALUE(    -1.73), SIMDE_FLOAT16_VALUE(  -241.62), SIMDE_FLOAT16_VALUE(    86.56), SIMDE_FLOAT16_VALUE(   -84.56),
        SIMDE_FLOAT16_VALUE(   -20.62), SIMDE_FLOAT16_VALUE(   256.50), SIMDE_FLOAT16_VALUE(  -146.00), SIMDE_FLOAT16_VALUE(  -175.62) },
      { SIMDE_FLOAT16_VALUE(    71.81), SIMDE_FLOAT16_VALUE(  -114.94), SIMDE_FLOAT16_VALUE(   -27.30), SIMDE_FLOAT16_VALUE(   288.75) },
       INT32_C(           0),
      { SIMDE_FLOAT16_VALUE(-27536.00), SIMDE_FLOAT16_VALUE(-17056.00), SIMDE_FLOAT16_VALUE( -9424.00), SIMDE_FLOAT16_VALUE( -6144.00),
        SIMDE_FLOAT16_VALUE( 29296.00), SIMDE_FLOAT16_VALUE( 18192.00), SIMDE_FLOAT16_VALUE(-20048.00), SIMDE_FLOAT16_VALUE(-12824.00) } },
    { { SIMDE_FLOAT16_VALUE(   185.25), SIMDE_FLOAT16_VALUE(   -58.22), SIMDE_FLOAT16_VALUE(  -113.69), SIMDE_FLOAT16_VALUE(  -182.62),
        SIMDE_FLOAT16_VALUE(   168.50), SIMDE_FLOAT16_VALUE(  -211.75), SIMDE_FLOAT16_VALUE(    10.17), SIMDE_FLOAT16_VALUE(    -3.79) },
      { SIMDE_FLOAT16_VALUE(   -58.28), SIMDE_FLOAT16_VALUE(    84.44), SIMDE_FLOAT16_VALUE(    33.69), SIMDE_FLOAT16_VALUE(   -95.75),
        SIMDE_FLOAT16_VALUE(   -16.70), SIMDE_FLOAT16_VALUE(   -81.19), SIMDE_FLOAT16_VALUE(   179.75), SIMDE_FLOAT16_VALUE(  -265.50) },
      { SIMDE_FLOAT16_VALUE(   -46.53), SIMDE_FLOAT16_VALUE(  -159.88), SIMDE_FLOAT16_VALUE(  -219.88), SIMDE_FLOAT16_VALUE(  -158.50) },
       INT32_C(           1),
      { SIMDE_FLOAT16_VALUE( 13568.00), SIMDE_FLOAT16_VALUE(-18624.00), SIMDE_FLOAT16_VALUE(-15288.00), SIMDE_FLOAT16_VALUE( 20864.00),
        SIMDE_FLOAT16_VALUE(-12696.00), SIMDE_FLOAT16_VALUE( 17632.00), SIMDE_FLOAT16_VALUE(-42080.00), SIMDE_FLOAT16_VALUE( 58368.00) } },
    { { SIMDE_FLOAT16_VALUE(   135.88), SIMDE_FLOAT16_VALUE(   117.19), SIMDE_FLOAT16_VALUE(   192.75), SIMDE_FLOAT16_VALUE(   273.00),
        SIMDE_FLOAT16_VALUE(   -24.16), SIMDE_FLOAT16_VALUE(  -274.00), SIMDE_FLOAT16_VALUE(   159.75), SIMDE_FLOAT16_VALUE(   258.00) },
      { SIMDE_FLOAT16_VALUE(   -78.50), SIMDE_FLOAT16_VALUE(   209.25), SIMDE_FLOAT16_VALUE(     1.54), SIMDE_FLOAT16_VALUE(    48.72),
        SIMDE_FLOAT16_VALUE(   284.25), SIMDE_FLOAT16_VALUE(  -125.50), SIMDE_FLOAT16_VALUE(   -24.08), SIMDE_FLOAT16_VALUE(   254.38) },
      { SIMDE_FLOAT16_VALUE(  -296.00), SIMDE_FLOAT16_VALUE(   127.06), SIMDE_FLOAT16_VALUE(   275.00), SIMDE_FLOAT16_VALUE(   145.12) },
       INT32_C(           0),
      { SIMDE_FLOAT16_VALUE(-26448.00), SIMDE_FLOAT16_VALUE(-61824.00), SIMDE_FLOAT16_VALUE( -5996.00), SIMDE_FLOAT16_VALUE(-14144.00),
        SIMDE_FLOAT16_VALUE( 15920.00), SIMDE_FLOAT16_VALUE( 36864.00), SIMDE_FLOAT16_VALUE(-32160.00),     -SIMDE_INFINITYHF } },
    { { SIMDE_FLOAT16_VALUE(  -155.12), SIMDE_FLOAT16_VALUE(  -291.50), SIMDE_FLOAT16_VALUE(   294.25), SIMDE_FLOAT16_VALUE(  -271.25),
        SIMDE_FLOAT16_VALUE(  -111.75), SIMDE_FLOAT16_VALUE(   -24.73), SIMDE_FLOAT16_VALUE(     8.03), SIMDE_FLOAT16_VALUE(    -7.80) },
      { SIMDE_FLOAT16_VALUE(  -248.50), SIMDE_FLOAT16_VALUE(  -139.38), SIMDE_FLOAT16_VALUE(  -249.50), SIMDE_FLOAT16_VALUE(   261.50),
        SIMDE_FLOAT16_VALUE(   278.75), SIMDE_FLOAT16_VALUE(   188.00), SIMDE_FLOAT16_VALUE(   -76.56), SIMDE_FLOAT16_VALUE(   159.50) },
      { SIMDE_FLOAT16_VALUE(   254.50), SIMDE_FLOAT16_VALUE(  -161.38), SIMDE_FLOAT16_VALUE(  -257.25), SIMDE_FLOAT16_VALUE(  -197.00) },
       INT32_C(           1),
      { SIMDE_FLOAT16_VALUE(-27616.00), SIMDE_FLOAT16_VALUE( 35552.00), SIMDE_FLOAT16_VALUE( 51808.00),     -SIMDE_INFINITYHF,
        SIMDE_FLOAT16_VALUE( 36928.00), SIMDE_FLOAT16_VALUE(-48384.00), SIMDE_FLOAT16_VALUE( 31424.00), SIMDE_FLOAT16_VALUE(-41024.00) } }
  };

  for (size_t i = 0 ; i < (sizeof(test_vec) / sizeof(test_vec[0])) ; i++) {
    simde_float16x8_t r_ = simde_vld1q_f16(test_vec[i].r_);
    simde_float16x8_t a = simde_vld1q_f16(test_vec[i].a);
    simde_float16x4_t b = simde_vld1_f16(test_vec[i].b);
    simde_float16x8_t r;
    SIMDE_CONSTIFY_2_(simde_vcmlaq_rot90_lane_f16, r, (HEDLEY_UNREACHABLE(), simde_vdupq_n_f16(SIMDE_FLOAT16_VALUE(0.0))), test_vec[i].lane, r_, a, b);

    simde_test_arm_neon_assert_equal_f16x8(r, simde_vld1q_f16(test_vec[i].r), 1);
  }

  return 0;
#else
  fputc('\n', stdout);
  const int lanes[] = { 0, 1, 0, 1, 0, 1, 0, 1 };
  for (int i = 0 ; i < 8 ; i++) {
    simde_float16x8_t r_ = simde_test_arm_neon_random_f16x8(-300.0f, 300.0f);
    simde_float16x8_t a = simde_test_arm_neon_random_f16x8(-300.0f, 300.0f);
    simde_float16x4_t b = simde_test_arm_neon_random_f16x4(-300.0f, 300.0f);
    simde_float16x8_t r;
    if(i % 2)
      r = simde_vcmlaq_rot90_lane_f16(r_, a, b, 1);
    else
      r = simde_vcmlaq_rot90_lane_f16(r_, a, b, 0);


    simde_test_arm_neon_write_f16x8(2, r_, SIMDE_TEST_VEC_POS_FIRST);
    simde_test_arm_neon_write_f16x8(2, a, SIMDE_TEST_VEC_POS_MIDDLE);
    simde_test_arm_neon_write_f16x4(2, b, SIMDE_TEST_VEC_POS_MIDDLE);
    simde_test_codegen_write_i32(2, lanes[i], SIMDE_TEST_VEC_POS_MIDDLE);
    simde_test_arm_neon_write_f16x8(2, r, SIMDE_TEST_VEC_POS_LAST);
  }
  return 1;
#endif
}

static int
test_simde_vcmlaq_rot90_lane_f32 (SIMDE_MUNIT_TEST_ARGS) {
#if 1
  static const struct {
    simde_float32_t r_[4];
    simde_float32_t a[4];
    simde_float32_t b[2];
    const int lane;
    simde_float32_t r[4];
  } test_vec[] = {
    { { SIMDE_FLOAT32_C(  -606.87), SIMDE_FLOAT32_C(   281.36), SIMDE_FLOAT32_C(   801.90), SIMDE_FLOAT32_C(  -480.25) },
      { SIMDE_FLOAT32_C(   411.57), SIMDE_FLOAT32_C(  -814.05), SIMDE_FLOAT32_C(   184.06), SIMDE_FLOAT32_C(  -535.08) },
      { SIMDE_FLOAT32_C(   882.55), SIMDE_FLOAT32_C(  -925.53) },
       INT32_C(           0),
      { SIMDE_FLOAT32_C(-754034.56), SIMDE_FLOAT32_C(-718158.44), SIMDE_FLOAT32_C(-494430.72), SIMDE_FLOAT32_C(-472715.12) } },
    { { SIMDE_FLOAT32_C(   594.05), SIMDE_FLOAT32_C(   232.07), SIMDE_FLOAT32_C(   398.96), SIMDE_FLOAT32_C(  -609.08) },
      { SIMDE_FLOAT32_C(  -871.17), SIMDE_FLOAT32_C(   293.96), SIMDE_FLOAT32_C(   517.18), SIMDE_FLOAT32_C(   204.91) },
      { SIMDE_FLOAT32_C(   -35.71), SIMDE_FLOAT32_C(   -93.52) },
       INT32_C(           0),
      { SIMDE_FLOAT32_C( 28085.19), SIMDE_FLOAT32_C(-10265.24), SIMDE_FLOAT32_C( 19562.14), SIMDE_FLOAT32_C( -7926.42) } },
    { { SIMDE_FLOAT32_C(   155.46), SIMDE_FLOAT32_C(   900.57), SIMDE_FLOAT32_C(  -176.49), SIMDE_FLOAT32_C(  -313.50) },
      { SIMDE_FLOAT32_C(  -945.97), SIMDE_FLOAT32_C(  -983.21), SIMDE_FLOAT32_C(  -879.75), SIMDE_FLOAT32_C(     1.24) },
      { SIMDE_FLOAT32_C(   780.08), SIMDE_FLOAT32_C(   848.20) },
       INT32_C(           0),
      { SIMDE_FLOAT32_C(834114.19), SIMDE_FLOAT32_C(-766081.94), SIMDE_FLOAT32_C( -1228.26), SIMDE_FLOAT32_C(   653.80) } },
    { { SIMDE_FLOAT32_C(  -351.64), SIMDE_FLOAT32_C(   -64.68), SIMDE_FLOAT32_C(  -995.56), SIMDE_FLOAT32_C(  -362.89) },
      { SIMDE_FLOAT32_C(   901.16), SIMDE_FLOAT32_C(  -172.25), SIMDE_FLOAT32_C(  -978.90), SIMDE_FLOAT32_C(  -308.35) },
      { SIMDE_FLOAT32_C(  -444.48), SIMDE_FLOAT32_C(  -372.12) },
       INT32_C(           0),
      { SIMDE_FLOAT32_C(-64449.31), SIMDE_FLOAT32_C( 76497.00), SIMDE_FLOAT32_C(-115738.77), SIMDE_FLOAT32_C(136692.53) } },
    { { SIMDE_FLOAT32_C(  -163.82), SIMDE_FLOAT32_C(   689.83), SIMDE_FLOAT32_C(   -34.71), SIMDE_FLOAT32_C(   582.23) },
      { SIMDE_FLOAT32_C(  -437.81), SIMDE_FLOAT32_C(  -260.96), SIMDE_FLOAT32_C(    80.70), SIMDE_FLOAT32_C(   298.00) },
      { SIMDE_FLOAT32_C(   457.76), SIMDE_FLOAT32_C(  -360.82) },
       INT32_C(           0),
      { SIMDE_FLOAT32_C(-94323.41), SIMDE_FLOAT32_C(-118767.22), SIMDE_FLOAT32_C(107489.65), SIMDE_FLOAT32_C(136994.72) } },
    { { SIMDE_FLOAT32_C(  -323.42), SIMDE_FLOAT32_C(   363.30), SIMDE_FLOAT32_C(    19.16), SIMDE_FLOAT32_C(    93.73) },
      { SIMDE_FLOAT32_C(  -615.85), SIMDE_FLOAT32_C(  -568.20), SIMDE_FLOAT32_C(   284.35), SIMDE_FLOAT32_C(  -908.64) },
      { SIMDE_FLOAT32_C(   518.90), SIMDE_FLOAT32_C(  -783.50) },
       INT32_C(           0),
      { SIMDE_FLOAT32_C(-445508.12), SIMDE_FLOAT32_C(-294475.69), SIMDE_FLOAT32_C(-711900.31), SIMDE_FLOAT32_C(-471399.59) } },
    { { SIMDE_FLOAT32_C(  -345.76), SIMDE_FLOAT32_C(   786.53), SIMDE_FLOAT32_C(  -753.21), SIMDE_FLOAT32_C(   838.46) },
      { SIMDE_FLOAT32_C(    69.23), SIMDE_FLOAT32_C(  -531.56), SIMDE_FLOAT32_C(    30.71), SIMDE_FLOAT32_C(   222.17) },
      { SIMDE_FLOAT32_C(    85.60), SIMDE_FLOAT32_C(   619.29) },
       INT32_C(           0),
      { SIMDE_FLOAT32_C(328844.03), SIMDE_FLOAT32_C(-44715.00), SIMDE_FLOAT32_C(-138340.86), SIMDE_FLOAT32_C( 19856.21) } },
    { { SIMDE_FLOAT32_C(   368.53), SIMDE_FLOAT32_C(   -48.37), SIMDE_FLOAT32_C(  -925.98), SIMDE_FLOAT32_C(   977.19) },
      { SIMDE_FLOAT32_C(  -289.48), SIMDE_FLOAT32_C(   631.24), SIMDE_FLOAT32_C(  -676.98), SIMDE_FLOAT32_C(    70.37) },
      { SIMDE_FLOAT32_C(   645.05), SIMDE_FLOAT32_C(  -714.66) },
       INT32_C(           0),
      { SIMDE_FLOAT32_C(451490.50), SIMDE_FLOAT32_C(407132.97), SIMDE_FLOAT32_C( 49364.64), SIMDE_FLOAT32_C( 46369.36) } }
  };

  for (size_t i = 0 ; i < (sizeof(test_vec) / sizeof(test_vec[0])) ; i++) {
    simde_float32x4_t r_ = simde_vld1q_f32(test_vec[i].r_);
    simde_float32x4_t a = simde_vld1q_f32(test_vec[i].a);
    simde_float32x2_t b = simde_vld1_f32(test_vec[i].b);
    simde_float32x4_t r = simde_vcmlaq_rot90_lane_f32(r_, a, b, 0);
    simde_test_arm_neon_assert_equal_f32x4(r, simde_vld1q_f32(test_vec[i].r), 1);
  }
  return 0;
#else
  fputc('\n', stdout);
  const int lanes[] = { 0, 0, 0, 0, 0, 0, 0, 0 };
  for (int i = 0 ; i < 8 ; i++) {
    simde_float32x4_t r_ = simde_test_arm_neon_random_f32x4(-1000.0f, 1000.0f);
    simde_float32x4_t a = simde_test_arm_neon_random_f32x4(-1000.0f, 1000.0f);
    simde_float32x2_t b = simde_test_arm_neon_random_f32x2(-1000.0f, 1000.0f);
    simde_float32x4_t r = simde_vcmlaq_rot90_lane_f32(r_, a, b, 0);


    simde_test_arm_neon_write_f32x4(2, r_, SIMDE_TEST_VEC_POS_FIRST);
    simde_test_arm_neon_write_f32x4(2, a, SIMDE_TEST_VEC_POS_MIDDLE);
    simde_test_arm_neon_write_f32x2(2, b, SIMDE_TEST_VEC_POS_MIDDLE);
    simde_test_codegen_write_i32(2, 0, SIMDE_TEST_VEC_POS_MIDDLE);
    simde_test_arm_neon_write_f32x4(2, r, SIMDE_TEST_VEC_POS_LAST);
  }
  return 1;
#endif
}

static int
test_simde_vcmlaq_rot90_laneq_f16 (SIMDE_MUNIT_TEST_ARGS) {
#if 1
  struct {
    simde_float16_t r_[8];
    simde_float16_t a[8];
    simde_float16_t b[8];
    const int lane;
    simde_float16_t r[8];
  } test_vec[] = {
    { { SIMDE_FLOAT16_VALUE(   -19.59), SIMDE_FLOAT16_VALUE(    51.03), SIMDE_FLOAT16_VALUE(  -178.62), SIMDE_FLOAT16_VALUE(   228.88),
        SIMDE_FLOAT16_VALUE(   256.75), SIMDE_FLOAT16_VALUE(  -233.88), SIMDE_FLOAT16_VALUE(  -286.50), SIMDE_FLOAT16_VALUE(    28.12) },
      { SIMDE_FLOAT16_VALUE(    35.69), SIMDE_FLOAT16_VALUE(   217.62), SIMDE_FLOAT16_VALUE(  -139.62), SIMDE_FLOAT16_VALUE(  -300.00),
        SIMDE_FLOAT16_VALUE(   251.50), SIMDE_FLOAT16_VALUE(    -5.78), SIMDE_FLOAT16_VALUE(   117.31), SIMDE_FLOAT16_VALUE(  -203.50) },
      { SIMDE_FLOAT16_VALUE(    93.19), SIMDE_FLOAT16_VALUE(  -136.12), SIMDE_FLOAT16_VALUE(   233.50), SIMDE_FLOAT16_VALUE(   106.50),
        SIMDE_FLOAT16_VALUE(   114.38), SIMDE_FLOAT16_VALUE(    -2.94), SIMDE_FLOAT16_VALUE(  -216.62), SIMDE_FLOAT16_VALUE(   297.75) },
       INT32_C(           0),
      { SIMDE_FLOAT16_VALUE( 29600.00), SIMDE_FLOAT16_VALUE( 20336.00), SIMDE_FLOAT16_VALUE(-41024.00), SIMDE_FLOAT16_VALUE(-27728.00),
        SIMDE_FLOAT16_VALUE(  -530.00), SIMDE_FLOAT16_VALUE(  -772.50), SIMDE_FLOAT16_VALUE(-27984.00), SIMDE_FLOAT16_VALUE(-18928.00) } },
    { { SIMDE_FLOAT16_VALUE(   167.25), SIMDE_FLOAT16_VALUE(   206.50), SIMDE_FLOAT16_VALUE(   -99.31), SIMDE_FLOAT16_VALUE(   118.12),
        SIMDE_FLOAT16_VALUE(   289.00), SIMDE_FLOAT16_VALUE(  -119.81), SIMDE_FLOAT16_VALUE(   241.88), SIMDE_FLOAT16_VALUE(  -248.88) },
      { SIMDE_FLOAT16_VALUE(    53.22), SIMDE_FLOAT16_VALUE(  -160.00), SIMDE_FLOAT16_VALUE(   218.50), SIMDE_FLOAT16_VALUE(   255.38),
        SIMDE_FLOAT16_VALUE(   126.88), SIMDE_FLOAT16_VALUE(  -298.00), SIMDE_FLOAT16_VALUE(   -40.31), SIMDE_FLOAT16_VALUE(  -113.88) },
      { SIMDE_FLOAT16_VALUE(  -237.50), SIMDE_FLOAT16_VALUE(   223.62), SIMDE_FLOAT16_VALUE(  -237.25), SIMDE_FLOAT16_VALUE(   104.19),
        SIMDE_FLOAT16_VALUE(   160.38), SIMDE_FLOAT16_VALUE(     2.51), SIMDE_FLOAT16_VALUE(   159.38), SIMDE_FLOAT16_VALUE(  -231.25) },
       INT32_C(           1),
      { SIMDE_FLOAT16_VALUE( 16832.00), SIMDE_FLOAT16_VALUE( 38176.00), SIMDE_FLOAT16_VALUE(-26704.00), SIMDE_FLOAT16_VALUE(-60480.00),
        SIMDE_FLOAT16_VALUE( 31344.00),      SIMDE_INFINITYHF, SIMDE_FLOAT16_VALUE( 12104.00), SIMDE_FLOAT16_VALUE( 26768.00) } },
    { { SIMDE_FLOAT16_VALUE(  -261.75), SIMDE_FLOAT16_VALUE(  -294.75), SIMDE_FLOAT16_VALUE(  -247.12), SIMDE_FLOAT16_VALUE(   -12.74),
        SIMDE_FLOAT16_VALUE(    31.02), SIMDE_FLOAT16_VALUE(    21.56), SIMDE_FLOAT16_VALUE(   160.12), SIMDE_FLOAT16_VALUE(   103.62) },
      { SIMDE_FLOAT16_VALUE(  -297.50), SIMDE_FLOAT16_VALUE(   102.81), SIMDE_FLOAT16_VALUE(    86.25), SIMDE_FLOAT16_VALUE(    62.19),
        SIMDE_FLOAT16_VALUE(   -27.45), SIMDE_FLOAT16_VALUE(   -16.95), SIMDE_FLOAT16_VALUE(  -127.06), SIMDE_FLOAT16_VALUE(  -117.25) },
      { SIMDE_FLOAT16_VALUE(  -264.50), SIMDE_FLOAT16_VALUE(   211.75), SIMDE_FLOAT16_VALUE(  -246.62), SIMDE_FLOAT16_VALUE(    12.98),
        SIMDE_FLOAT16_VALUE(  -180.25), SIMDE_FLOAT16_VALUE(   -40.56), SIMDE_FLOAT16_VALUE(  -255.25), SIMDE_FLOAT16_VALUE(    15.09) },
       INT32_C(           2),
      { SIMDE_FLOAT16_VALUE(  3908.00), SIMDE_FLOAT16_VALUE(-18832.00), SIMDE_FLOAT16_VALUE(  2276.00), SIMDE_FLOAT16_VALUE(-11224.00),
        SIMDE_FLOAT16_VALUE(  -656.50), SIMDE_FLOAT16_VALUE(  3078.00), SIMDE_FLOAT16_VALUE( -4596.00), SIMDE_FLOAT16_VALUE( 21232.00) } },
    { { SIMDE_FLOAT16_VALUE(  -222.62), SIMDE_FLOAT16_VALUE(   280.50), SIMDE_FLOAT16_VALUE(    85.06), SIMDE_FLOAT16_VALUE(  -190.50),
        SIMDE_FLOAT16_VALUE(   132.88), SIMDE_FLOAT16_VALUE(   -60.09), SIMDE_FLOAT16_VALUE(    85.75), SIMDE_FLOAT16_VALUE(   250.88) },
      { SIMDE_FLOAT16_VALUE(   240.62), SIMDE_FLOAT16_VALUE(  -165.00), SIMDE_FLOAT16_VALUE(   141.00), SIMDE_FLOAT16_VALUE(   225.00),
        SIMDE_FLOAT16_VALUE(  -253.12), SIMDE_FLOAT16_VALUE(  -129.12), SIMDE_FLOAT16_VALUE(  -118.88), SIMDE_FLOAT16_VALUE(   217.00) },
      { SIMDE_FLOAT16_VALUE(   -19.73), SIMDE_FLOAT16_VALUE(    14.75), SIMDE_FLOAT16_VALUE(    81.31), SIMDE_FLOAT16_VALUE(   283.50),
        SIMDE_FLOAT16_VALUE(    64.75), SIMDE_FLOAT16_VALUE(  -132.50), SIMDE_FLOAT16_VALUE(   -60.78), SIMDE_FLOAT16_VALUE(   187.25) },
       INT32_C(           3),
      { SIMDE_FLOAT16_VALUE( 30672.00), SIMDE_FLOAT16_VALUE( 10312.00), SIMDE_FLOAT16_VALUE(-42048.00), SIMDE_FLOAT16_VALUE(-13864.00),
        SIMDE_FLOAT16_VALUE( 24304.00), SIMDE_FLOAT16_VALUE(  7788.00), SIMDE_FLOAT16_VALUE(-40544.00), SIMDE_FLOAT16_VALUE(-12936.00) } },
    { { SIMDE_FLOAT16_VALUE(  -127.06), SIMDE_FLOAT16_VALUE(    73.31), SIMDE_FLOAT16_VALUE(   278.50), SIMDE_FLOAT16_VALUE(  -258.75),
        SIMDE_FLOAT16_VALUE(   178.50), SIMDE_FLOAT16_VALUE(  -168.88), SIMDE_FLOAT16_VALUE(   275.00), SIMDE_FLOAT16_VALUE(  -214.88) },
      { SIMDE_FLOAT16_VALUE(  -257.25), SIMDE_FLOAT16_VALUE(   227.12), SIMDE_FLOAT16_VALUE(   245.12), SIMDE_FLOAT16_VALUE(    51.72),
        SIMDE_FLOAT16_VALUE(    20.47), SIMDE_FLOAT16_VALUE(  -297.50), SIMDE_FLOAT16_VALUE(  -280.00), SIMDE_FLOAT16_VALUE(    27.19) },
      { SIMDE_FLOAT16_VALUE(   171.62), SIMDE_FLOAT16_VALUE(   115.06), SIMDE_FLOAT16_VALUE(    71.50), SIMDE_FLOAT16_VALUE(   -71.81),
        SIMDE_FLOAT16_VALUE(  -244.88), SIMDE_FLOAT16_VALUE(  -241.25), SIMDE_FLOAT16_VALUE(    -1.39), SIMDE_FLOAT16_VALUE(    12.91) },
       INT32_C(           0),
      { SIMDE_FLOAT16_VALUE(-26256.00), SIMDE_FLOAT16_VALUE( 39040.00), SIMDE_FLOAT16_VALUE( -5672.00), SIMDE_FLOAT16_VALUE(  8616.00),
        SIMDE_FLOAT16_VALUE( 34400.00), SIMDE_FLOAT16_VALUE(-51232.00), SIMDE_FLOAT16_VALUE( -2854.00), SIMDE_FLOAT16_VALUE(  4452.00) } },
    { { SIMDE_FLOAT16_VALUE(  -156.25), SIMDE_FLOAT16_VALUE(  -234.75), SIMDE_FLOAT16_VALUE(  -133.38), SIMDE_FLOAT16_VALUE(  -188.38),
        SIMDE_FLOAT16_VALUE(   241.25), SIMDE_FLOAT16_VALUE(   197.25), SIMDE_FLOAT16_VALUE(   172.88), SIMDE_FLOAT16_VALUE(  -118.31) },
      { SIMDE_FLOAT16_VALUE(   137.75), SIMDE_FLOAT16_VALUE(   246.62), SIMDE_FLOAT16_VALUE(   -70.44), SIMDE_FLOAT16_VALUE(  -130.88),
        SIMDE_FLOAT16_VALUE(   263.75), SIMDE_FLOAT16_VALUE(   291.50), SIMDE_FLOAT16_VALUE(   181.88), SIMDE_FLOAT16_VALUE(   155.12) },
      { SIMDE_FLOAT16_VALUE(   -44.12), SIMDE_FLOAT16_VALUE(   -89.38), SIMDE_FLOAT16_VALUE(   111.81), SIMDE_FLOAT16_VALUE(   235.00),
        SIMDE_FLOAT16_VALUE(  -132.25), SIMDE_FLOAT16_VALUE(  -200.12), SIMDE_FLOAT16_VALUE(  -104.94), SIMDE_FLOAT16_VALUE(   -25.84) },
       INT32_C(           1),
      { SIMDE_FLOAT16_VALUE(-58112.00), SIMDE_FLOAT16_VALUE( 27344.00), SIMDE_FLOAT16_VALUE( 30624.00), SIMDE_FLOAT16_VALUE(-14824.00),
            -SIMDE_INFINITYHF, SIMDE_FLOAT16_VALUE( 32800.00), SIMDE_FLOAT16_VALUE(-36288.00), SIMDE_FLOAT16_VALUE( 17232.00) } },
    { { SIMDE_FLOAT16_VALUE(    43.12), SIMDE_FLOAT16_VALUE(  -158.25), SIMDE_FLOAT16_VALUE(   126.88), SIMDE_FLOAT16_VALUE(   -91.75),
        SIMDE_FLOAT16_VALUE(   -54.44), SIMDE_FLOAT16_VALUE(   -30.19), SIMDE_FLOAT16_VALUE(  -170.75), SIMDE_FLOAT16_VALUE(  -185.00) },
      { SIMDE_FLOAT16_VALUE(  -258.00), SIMDE_FLOAT16_VALUE(  -176.62), SIMDE_FLOAT16_VALUE(    66.81), SIMDE_FLOAT16_VALUE(  -202.62),
        SIMDE_FLOAT16_VALUE(  -259.00), SIMDE_FLOAT16_VALUE(   -38.12), SIMDE_FLOAT16_VALUE(     3.38), SIMDE_FLOAT16_VALUE(  -198.25) },
      { SIMDE_FLOAT16_VALUE(  -230.62), SIMDE_FLOAT16_VALUE(  -233.62), SIMDE_FLOAT16_VALUE(   277.50), SIMDE_FLOAT16_VALUE(  -234.00),
        SIMDE_FLOAT16_VALUE(   -15.50), SIMDE_FLOAT16_VALUE(  -156.50), SIMDE_FLOAT16_VALUE(  -287.75), SIMDE_FLOAT16_VALUE(  -103.75) },
       INT32_C(           2),
      { SIMDE_FLOAT16_VALUE(-27600.00), SIMDE_FLOAT16_VALUE(  2580.00), SIMDE_FLOAT16_VALUE(-31584.00), SIMDE_FLOAT16_VALUE(  3048.00),
        SIMDE_FLOAT16_VALUE( -6020.00), SIMDE_FLOAT16_VALUE(   561.00), SIMDE_FLOAT16_VALUE(-31200.00), SIMDE_FLOAT16_VALUE(  2888.00) } },
    { { SIMDE_FLOAT16_VALUE(    64.69), SIMDE_FLOAT16_VALUE(  -164.62), SIMDE_FLOAT16_VALUE(    27.31), SIMDE_FLOAT16_VALUE(   -73.00),
        SIMDE_FLOAT16_VALUE(  -293.75), SIMDE_FLOAT16_VALUE(   -36.22), SIMDE_FLOAT16_VALUE(   273.75), SIMDE_FLOAT16_VALUE(  -226.25) },
      { SIMDE_FLOAT16_VALUE(    -6.81), SIMDE_FLOAT16_VALUE(   173.00), SIMDE_FLOAT16_VALUE(   126.69), SIMDE_FLOAT16_VALUE(    43.59),
        SIMDE_FLOAT16_VALUE(   -54.50), SIMDE_FLOAT16_VALUE(  -181.62), SIMDE_FLOAT16_VALUE(  -166.12), SIMDE_FLOAT16_VALUE(   103.25) },
      { SIMDE_FLOAT16_VALUE(  -126.50), SIMDE_FLOAT16_VALUE(   -21.17), SIMDE_FLOAT16_VALUE(    43.66), SIMDE_FLOAT16_VALUE(    67.38),
        SIMDE_FLOAT16_VALUE(   -91.38), SIMDE_FLOAT16_VALUE(    79.56), SIMDE_FLOAT16_VALUE(    60.91), SIMDE_FLOAT16_VALUE(  -100.75) },
       INT32_C(           3),
      { SIMDE_FLOAT16_VALUE( 17488.00), SIMDE_FLOAT16_VALUE( 10376.00), SIMDE_FLOAT16_VALUE(  4420.00), SIMDE_FLOAT16_VALUE(  2582.00),
        SIMDE_FLOAT16_VALUE(-18592.00), SIMDE_FLOAT16_VALUE(-11096.00), SIMDE_FLOAT16_VALUE( 10680.00), SIMDE_FLOAT16_VALUE(  6064.00) } }
  };

  for (size_t i = 0 ; i < (sizeof(test_vec) / sizeof(test_vec[0])) ; i++) {
    simde_float16x8_t r_ = simde_vld1q_f16(test_vec[i].r_);
    simde_float16x8_t a = simde_vld1q_f16(test_vec[i].a);
    simde_float16x8_t b = simde_vld1q_f16(test_vec[i].b);
    simde_float16x8_t r;
    SIMDE_CONSTIFY_4_(simde_vcmlaq_rot90_laneq_f16, r, (HEDLEY_UNREACHABLE(), simde_vdupq_n_f16(SIMDE_FLOAT16_VALUE(0.0))), test_vec[i].lane, r_, a, b);

    simde_test_arm_neon_assert_equal_f16x8(r, simde_vld1q_f16(test_vec[i].r), 1);
  }
  return 0;
#else
  fputc('\n', stdout);
  const int lanes[] = { 0, 1, 2, 3, 0, 1, 2, 3 };
  for (int i = 0 ; i < 8 ; i++) {
    simde_float16x8_t r_ = simde_test_arm_neon_random_f16x8(-300.0f, 300.0f);
    simde_float16x8_t a = simde_test_arm_neon_random_f16x8(-300.0f, 300.0f);
    simde_float16x8_t b = simde_test_arm_neon_random_f16x8(-300.0f, 300.0f);
    simde_float16x8_t r;
    if(i % 4 == 1)
      r = simde_vcmlaq_rot90_laneq_f16(r_, a, b, 1);
    else if(i % 4 == 2)
      r = simde_vcmlaq_rot90_laneq_f16(r_, a, b, 2);
    else if(i % 4 == 3)
      r = simde_vcmlaq_rot90_laneq_f16(r_, a, b, 3);
    else
      r = simde_vcmlaq_rot90_laneq_f16(r_, a, b, 0);


    simde_test_arm_neon_write_f16x8(2, r_, SIMDE_TEST_VEC_POS_FIRST);
    simde_test_arm_neon_write_f16x8(2, a, SIMDE_TEST_VEC_POS_MIDDLE);
    simde_test_arm_neon_write_f16x8(2, b, SIMDE_TEST_VEC_POS_MIDDLE);
    simde_test_codegen_write_i32(2, lanes[i], SIMDE_TEST_VEC_POS_MIDDLE);
    simde_test_arm_neon_write_f16x8(2, r, SIMDE_TEST_VEC_POS_LAST);
  }
  return 1;
#endif
}

static int
test_simde_vcmlaq_rot90_laneq_f32 (SIMDE_MUNIT_TEST_ARGS) {
#if 1
  static const struct {
    simde_float32_t r_[4];
    simde_float32_t a[4];
    simde_float32_t b[4];
    const int lane;
    simde_float32_t r[4];
  } test_vec[] = {
    { { SIMDE_FLOAT32_C(   676.67), SIMDE_FLOAT32_C(   809.94), SIMDE_FLOAT32_C(   595.46), SIMDE_FLOAT32_C(   -62.91) },
      { SIMDE_FLOAT32_C(   733.19), SIMDE_FLOAT32_C(   660.73), SIMDE_FLOAT32_C(   919.31), SIMDE_FLOAT32_C(   865.27) },
      { SIMDE_FLOAT32_C(   552.03), SIMDE_FLOAT32_C(    43.45), SIMDE_FLOAT32_C(   223.82), SIMDE_FLOAT32_C(  -305.96) },
       INT32_C(           0),
      { SIMDE_FLOAT32_C(-28032.05), SIMDE_FLOAT32_C(365552.72), SIMDE_FLOAT32_C(-37000.52), SIMDE_FLOAT32_C(477592.12) } },
    { { SIMDE_FLOAT32_C(  -311.58), SIMDE_FLOAT32_C(  -696.00), SIMDE_FLOAT32_C(   412.71), SIMDE_FLOAT32_C(   370.52) },
      { SIMDE_FLOAT32_C(  -655.85), SIMDE_FLOAT32_C(  -854.52), SIMDE_FLOAT32_C(    26.03), SIMDE_FLOAT32_C(  -448.41) },
      { SIMDE_FLOAT32_C(  -445.44), SIMDE_FLOAT32_C(  -523.36), SIMDE_FLOAT32_C(  -171.06), SIMDE_FLOAT32_C(  -991.16) },
       INT32_C(           1),
      { SIMDE_FLOAT32_C(-847277.62), SIMDE_FLOAT32_C(145478.19), SIMDE_FLOAT32_C(-444033.34), SIMDE_FLOAT32_C( 77075.53) } },
    { { SIMDE_FLOAT32_C(  -477.36), SIMDE_FLOAT32_C(   965.45), SIMDE_FLOAT32_C(   365.20), SIMDE_FLOAT32_C(   -47.26) },
      { SIMDE_FLOAT32_C(  -320.04), SIMDE_FLOAT32_C(  -977.54), SIMDE_FLOAT32_C(   467.18), SIMDE_FLOAT32_C(   -64.13) },
      { SIMDE_FLOAT32_C(   187.21), SIMDE_FLOAT32_C(   502.39), SIMDE_FLOAT32_C(  -307.04), SIMDE_FLOAT32_C(  -468.66) },
       INT32_C(           0),
      { SIMDE_FLOAT32_C(490628.97), SIMDE_FLOAT32_C(-182039.81), SIMDE_FLOAT32_C( 32583.47), SIMDE_FLOAT32_C(-12053.04) } },
    { { SIMDE_FLOAT32_C(  -786.03), SIMDE_FLOAT32_C(  -867.52), SIMDE_FLOAT32_C(  -431.74), SIMDE_FLOAT32_C(  -253.44) },
      { SIMDE_FLOAT32_C(   460.71), SIMDE_FLOAT32_C(  -919.05), SIMDE_FLOAT32_C(  -445.17), SIMDE_FLOAT32_C(    44.58) },
      { SIMDE_FLOAT32_C(  -825.63), SIMDE_FLOAT32_C(  -388.81), SIMDE_FLOAT32_C(  -741.36), SIMDE_FLOAT32_C(  -108.76) },
       INT32_C(           1),
      { SIMDE_FLOAT32_C(-100741.91), SIMDE_FLOAT32_C(680479.38), SIMDE_FLOAT32_C(  4416.78), SIMDE_FLOAT32_C(-33303.27) } },
    { { SIMDE_FLOAT32_C(    83.89), SIMDE_FLOAT32_C(    13.44), SIMDE_FLOAT32_C(  -139.40), SIMDE_FLOAT32_C(  -837.31) },
      { SIMDE_FLOAT32_C(  -677.17), SIMDE_FLOAT32_C(   758.42), SIMDE_FLOAT32_C(   746.93), SIMDE_FLOAT32_C(  -263.70) },
      { SIMDE_FLOAT32_C(    50.99), SIMDE_FLOAT32_C(   949.25), SIMDE_FLOAT32_C(    28.81), SIMDE_FLOAT32_C(   181.99) },
       INT32_C(           0),
      { SIMDE_FLOAT32_C(-719846.25), SIMDE_FLOAT32_C( 38685.28), SIMDE_FLOAT32_C(250177.84), SIMDE_FLOAT32_C(-14283.37) } },
    { { SIMDE_FLOAT32_C(   691.62), SIMDE_FLOAT32_C(   125.28), SIMDE_FLOAT32_C(  -398.94), SIMDE_FLOAT32_C(   944.80) },
      { SIMDE_FLOAT32_C(  -683.87), SIMDE_FLOAT32_C(   151.94), SIMDE_FLOAT32_C(  -261.12), SIMDE_FLOAT32_C(  -621.50) },
      { SIMDE_FLOAT32_C(   508.96), SIMDE_FLOAT32_C(   119.38), SIMDE_FLOAT32_C(   425.43), SIMDE_FLOAT32_C(   198.06) },
       INT32_C(           1),
      { SIMDE_FLOAT32_C(-29401.62), SIMDE_FLOAT32_C( 64765.11), SIMDE_FLOAT32_C(122695.35), SIMDE_FLOAT32_C(-263459.94) } },
    { { SIMDE_FLOAT32_C(   762.96), SIMDE_FLOAT32_C(  -981.39), SIMDE_FLOAT32_C(  -169.33), SIMDE_FLOAT32_C(    72.70) },
      { SIMDE_FLOAT32_C(  -114.99), SIMDE_FLOAT32_C(  -710.94), SIMDE_FLOAT32_C(  -760.59), SIMDE_FLOAT32_C(   775.78) },
      { SIMDE_FLOAT32_C(   573.04), SIMDE_FLOAT32_C(  -937.57), SIMDE_FLOAT32_C(   260.18), SIMDE_FLOAT32_C(   841.25) },
       INT32_C(           0),
      { SIMDE_FLOAT32_C(-665793.06), SIMDE_FLOAT32_C(-408378.44), SIMDE_FLOAT32_C(727178.75), SIMDE_FLOAT32_C(444625.66) } },
    { { SIMDE_FLOAT32_C(   901.11), SIMDE_FLOAT32_C(   914.32), SIMDE_FLOAT32_C(   982.77), SIMDE_FLOAT32_C(  -516.71) },
      { SIMDE_FLOAT32_C(  -418.68), SIMDE_FLOAT32_C(  -701.93), SIMDE_FLOAT32_C(   671.63), SIMDE_FLOAT32_C(    18.58) },
      { SIMDE_FLOAT32_C(   306.45), SIMDE_FLOAT32_C(   540.11), SIMDE_FLOAT32_C(  -315.08), SIMDE_FLOAT32_C(   444.57) },
       INT32_C(           1),
      { SIMDE_FLOAT32_C(312958.12), SIMDE_FLOAT32_C(222078.41), SIMDE_FLOAT32_C( -7277.34), SIMDE_FLOAT32_C( -6370.90) } }
  };

  for (size_t i = 0 ; i < (sizeof(test_vec) / sizeof(test_vec[0])) ; i++) {
    simde_float32x4_t r_ = simde_vld1q_f32(test_vec[i].r_);
    simde_float32x4_t a = simde_vld1q_f32(test_vec[i].a);
    simde_float32x4_t b = simde_vld1q_f32(test_vec[i].b);
    simde_float32x4_t r;
    SIMDE_CONSTIFY_2_(simde_vcmlaq_rot90_laneq_f32, r, (HEDLEY_UNREACHABLE(), simde_vdupq_n_f32(SIMDE_FLOAT32_C(0.0))), test_vec[i].lane, r_, a, b);

    simde_test_arm_neon_assert_equal_f32x4(r, simde_vld1q_f32(test_vec[i].r), 1);
  }
  return 0;
#else
  fputc('\n', stdout);
  const int lanes[] = { 0, 1, 0, 1, 0, 1, 0, 1 };
  for (int i = 0 ; i < 8 ; i++) {
    simde_float32x4_t r_ = simde_test_arm_neon_random_f32x4(-1000.0f, 1000.0f);
    simde_float32x4_t a = simde_test_arm_neon_random_f32x4(-1000.0f, 1000.0f);
    simde_float32x4_t b = simde_test_arm_neon_random_f32x4(-1000.0f, 1000.0f);
    simde_float32x4_t r;
    if(i % 2 == 1)
      r = simde_vcmlaq_rot90_laneq_f32(r_, a, b, 1);
    else
      r = simde_vcmlaq_rot90_laneq_f32(r_, a, b, 0);

    simde_test_arm_neon_write_f32x4(2, r_, SIMDE_TEST_VEC_POS_FIRST);
    simde_test_arm_neon_write_f32x4(2, a, SIMDE_TEST_VEC_POS_MIDDLE);
    simde_test_arm_neon_write_f32x4(2, b, SIMDE_TEST_VEC_POS_MIDDLE);
    simde_test_codegen_write_i32(2, lanes[i], SIMDE_TEST_VEC_POS_MIDDLE);
    simde_test_arm_neon_write_f32x4(2, r, SIMDE_TEST_VEC_POS_LAST);
  }
  return 1;
#endif
}
SIMDE_TEST_FUNC_LIST_BEGIN
SIMDE_TEST_FUNC_LIST_ENTRY(vcmla_rot90_lane_f16)
SIMDE_TEST_FUNC_LIST_ENTRY(vcmla_rot90_lane_f32)
SIMDE_TEST_FUNC_LIST_ENTRY(vcmla_rot90_laneq_f16)
SIMDE_TEST_FUNC_LIST_ENTRY(vcmla_rot90_laneq_f32)
SIMDE_TEST_FUNC_LIST_ENTRY(vcmlaq_rot90_lane_f16)
SIMDE_TEST_FUNC_LIST_ENTRY(vcmlaq_rot90_lane_f32)
SIMDE_TEST_FUNC_LIST_ENTRY(vcmlaq_rot90_laneq_f16)
SIMDE_TEST_FUNC_LIST_ENTRY(vcmlaq_rot90_laneq_f32)
SIMDE_TEST_FUNC_LIST_END

#include "test-neon-footer.h"
